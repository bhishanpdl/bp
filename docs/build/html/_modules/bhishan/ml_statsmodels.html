
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <title>bhishan.ml_statsmodels &#8212; Bhishan 1 documentation</title>
    <link rel="stylesheet" href="../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Bhishan 1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for bhishan.ml_statsmodels</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">import</span> <span class="nn">statsmodels.formula.api</span> <span class="k">as</span> <span class="nn">smf</span>
<span class="kn">import</span> <span class="nn">statsmodels.robust</span> <span class="k">as</span> <span class="nn">smrb</span> <span class="c1"># smrb.mad() etc</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">HTML</span>


<div class="viewcode-block" id="regression_residual_plots"><a class="viewcode-back" href="../../bhishan.html#bhishan.ml_statsmodels.regression_residual_plots">[docs]</a><span class="k">def</span> <span class="nf">regression_residual_plots</span><span class="p">(</span><span class="n">model_fit</span><span class="p">,</span> <span class="n">dependent_var</span><span class="p">,</span>
                                <span class="n">data</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span>
                                <span class="n">cook_xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                <span class="n">cook_ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                <span class="n">annotate_outliers</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span>
                                <span class="n">ofile</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parameters</span>
<span class="sd">    -----------</span>
<span class="sd">    model_fit: object</span>
<span class="sd">        Fitted model from statsmodels.</span>
<span class="sd">    dependent_var: string</span>
<span class="sd">        Feature name for dependent variable.</span>
<span class="sd">    data: pandas.DataFrame</span>
<span class="sd">    size: list</span>
<span class="sd">        default is [10,10]. matplotlib figsize = [10,10]</span>

<span class="sd">    .. code-block:: python</span>

<span class="sd">        import matplotlib.pyplot as plt</span>
<span class="sd">        import statsmodels.api as sm</span>
<span class="sd">        model_fit = sm.OLS(endog= DEPENDENT VARIABLE, exog= INDEPENDENT VARIABLE).fit()</span>

<span class="sd">    NOTE:</span>
<span class="sd">    -------</span>
<span class="sd">    Ive only run it on simple, non-robust, ordinary least squares models,</span>
<span class="sd">    but these metrics are standard for linear models.</span>
<span class="sd">    Ref: https://www.kaggle.com/nicapotato/in-depth-simple-linear-regression</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Extract relevant regression output for plotting</span>
    <span class="c1"># fitted values (need a constant term for intercept)</span>
    <span class="n">model_fitted_y</span> <span class="o">=</span> <span class="n">model_fit</span><span class="o">.</span><span class="n">fittedvalues</span>
    <span class="c1"># model residuals</span>
    <span class="n">model_residuals</span> <span class="o">=</span> <span class="n">model_fit</span><span class="o">.</span><span class="n">resid</span>
    <span class="c1"># normalized residuals</span>
    <span class="n">model_norm_residuals</span> <span class="o">=</span> <span class="n">model_fit</span><span class="o">.</span><span class="n">get_influence</span><span class="p">()</span><span class="o">.</span><span class="n">resid_studentized_internal</span>
    <span class="c1"># absolute squared normalized residuals</span>
    <span class="n">model_norm_residuals_abs_sqrt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">model_norm_residuals</span><span class="p">))</span>
    <span class="c1"># absolute residuals</span>
    <span class="n">model_abs_resid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">model_residuals</span><span class="p">)</span>
    <span class="c1"># leverage, from statsmodels internals</span>
    <span class="n">model_leverage</span> <span class="o">=</span> <span class="n">model_fit</span><span class="o">.</span><span class="n">get_influence</span><span class="p">()</span><span class="o">.</span><span class="n">hat_matrix_diag</span>
    <span class="c1"># cook&#39;s distance, from statsmodels internals</span>
    <span class="n">model_cooks</span> <span class="o">=</span> <span class="n">model_fit</span><span class="o">.</span><span class="n">get_influence</span><span class="p">()</span><span class="o">.</span><span class="n">cooks_distance</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1">########################################################################</span>
    <span class="c1"># Plot Size</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>

    <span class="c1"># Residual vs. Fitted</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="c1"># Top Left</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">residplot</span><span class="p">(</span><span class="n">model_fitted_y</span><span class="p">,</span> <span class="n">dependent_var</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                    <span class="n">lowess</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">scatter_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">},</span>
                    <span class="n">line_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;lw&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">},</span>
                    <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Residuals vs Fitted&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Fitted values&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Residuals&#39;</span><span class="p">)</span>

    <span class="c1"># Annotations of Outliers</span>
    <span class="k">if</span> <span class="n">annotate_outliers</span><span class="p">:</span>
        <span class="n">abs_resid</span> <span class="o">=</span> <span class="n">model_abs_resid</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">abs_resid_top_3</span> <span class="o">=</span> <span class="n">abs_resid</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">abs_resid_top_3</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">model_fitted_y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">model_residuals</span><span class="p">[</span><span class="n">i</span><span class="p">]));</span>

    <span class="c1">########################################################################</span>
    <span class="c1"># Normal Q-Q</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="c1"># Top Right</span>
    <span class="n">QQ</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">ProbPlot</span><span class="p">(</span><span class="n">model_norm_residuals</span><span class="p">)</span>
    <span class="n">QQ</span><span class="o">.</span><span class="n">qqplot</span><span class="p">(</span><span class="n">line</span><span class="o">=</span><span class="s1">&#39;45&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#4C72B0&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Normal Q-Q&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Theoretical Quantiles&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Standardized Residuals&#39;</span><span class="p">)</span>

    <span class="c1"># Annotations of Outliers</span>
    <span class="k">if</span> <span class="n">annotate_outliers</span><span class="p">:</span>
        <span class="n">abs_norm_resid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">model_norm_residuals</span><span class="p">)),</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">abs_norm_resid_top_3</span> <span class="o">=</span> <span class="n">abs_norm_resid</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">r</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">abs_norm_resid_top_3</span><span class="p">):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">QQ</span><span class="o">.</span><span class="n">theoretical_quantiles</span><span class="p">,</span> <span class="mi">0</span><span class="p">)[</span><span class="n">r</span><span class="p">],</span>
                                    <span class="n">model_norm_residuals</span><span class="p">[</span><span class="n">i</span><span class="p">]));</span>

    <span class="c1">########################################################################</span>
    <span class="c1"># Scale-Location Plot</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="c1"># Bottom Left</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">model_fitted_y</span><span class="p">,</span> <span class="n">model_norm_residuals_abs_sqrt</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">model_fitted_y</span><span class="p">,</span> <span class="n">model_norm_residuals_abs_sqrt</span><span class="p">,</span>
                <span class="n">scatter</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">ci</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">lowess</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">line_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;lw&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">},</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Scale-Location&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Fitted values&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$\sqrt{|Standardized Residuals|}$&#39;</span><span class="p">);</span>
    <span class="c1"># Annotations of Outliers</span>
    <span class="n">abs_sq_norm_resid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">model_norm_residuals_abs_sqrt</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">abs_sq_norm_resid_top_3</span> <span class="o">=</span> <span class="n">abs_sq_norm_resid</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
    <span class="c1"># This gives points at wrong places.</span>
    <span class="c1"># for i in abs_norm_resid_top_3:</span>
    <span class="c1">#     try:</span>
    <span class="c1">#         ax.annotate(i,</span>
    <span class="c1">#                     xy=(model_fitted_y[i],</span>
    <span class="c1">#                     model_norm_residuals_abs_sqrt[i]));</span>
    <span class="c1">#     except:</span>
    <span class="c1">#         pass</span>


    <span class="c1">########################################################################</span>
    <span class="c1"># Cook&#39;s Distance Plot</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="c1"># Bottom Right</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">model_leverage</span><span class="p">,</span> <span class="n">model_norm_residuals</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">model_leverage</span><span class="p">,</span> <span class="n">model_norm_residuals</span><span class="p">,</span>
                <span class="n">scatter</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">ci</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">lowess</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">line_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;lw&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">},</span>
                <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">cook_xlim</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">cook_ylim</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Residuals vs Leverage&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Leverage&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Standardized Residuals&#39;</span><span class="p">)</span>

    <span class="c1"># Annotations</span>
    <span class="k">if</span> <span class="n">annotate_outliers</span><span class="p">:</span>
        <span class="n">leverage_top_3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">model_cooks</span><span class="p">),</span> <span class="mi">0</span><span class="p">)[:</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">leverage_top_3</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">model_leverage</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">model_norm_residuals</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>

    <span class="c1"># Shenanigans for Cook&#39;s distance contours</span>
    <span class="k">def</span> <span class="nf">graph</span><span class="p">(</span><span class="n">formula</span><span class="p">,</span> <span class="n">x_range</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x_range</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">formula</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="n">ls</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">model_fit</span><span class="o">.</span><span class="n">params</span><span class="p">)</span> <span class="c1"># number of model parameters</span>
    <span class="n">graph</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">p</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x</span><span class="p">))</span> <span class="o">/</span> <span class="n">x</span><span class="p">),</span>
            <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.200</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span>
            <span class="s1">&#39;Cook</span><span class="se">\&#39;</span><span class="s1">s distance 0.5&#39;</span><span class="p">)</span> <span class="c1"># 0.5 line</span>
    <span class="n">graph</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="mi">1</span> <span class="o">*</span> <span class="n">p</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x</span><span class="p">))</span> <span class="o">/</span> <span class="n">x</span><span class="p">),</span>
            <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.200</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Cook</span><span class="se">\&#39;</span><span class="s1">s distance 1.0&#39;</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span> <span class="c1"># 1 line</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">title</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ofile</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">ofile</span><span class="p">,</span><span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>

    <span class="n">html</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">&lt;div class=&quot;alert alert-block alert-info&quot;&gt;</span>
<span class="s2">&lt;div align=&quot;center&quot;&gt;</span>
<span class="s2">    &lt;h3&gt;Plot Diagnostics &lt;/h3&gt;</span>
<span class="s2">&lt;/div&gt;</span>
<span class="s2">&lt;h5&gt; &lt;span style=&quot;color:green&quot;&gt;1. Residuals vs Fitted Plot (Test of Linearity of Data) &lt;/span&gt; &lt;/h5&gt;&lt;br&gt;</span>
<span class="s2">    - If &lt;span style=&quot;color:red&quot;&gt; solid red line&lt;/span&gt; is along y=0, assumption of linearity holds true.&lt;br&gt;</span>
<span class="s2">    - If we see U-shaped &lt;span style=&quot;color:red&quot;&gt; solid red line&lt;/span&gt;, then</span>
<span class="s2">        our linear model is not providing a optimal fit to our data.&lt;br&gt;</span>
<span class="s2">    - The relationship is non-linear and we may need to make quadratic</span>
<span class="s2">        (or, other polynomial transformation of the data.)&lt;br&gt;</span>
<span class="s2">    - If we see residuals more varied as we go right or left,</span>
<span class="s2">        the assumption of of constant variance of residuals is violated. (Data is</span>
<span class="s2">        heteroskedastic.)&lt;br&gt;</span>
<span class="s2">    - In case of heteroskedasticity, we may need to log1p, boxcox1p, sqrt or do other transformations</span>
<span class="s2">        to make the dataset more uniform.&lt;br&gt;</span>

<span class="s2">&lt;h5&gt; &lt;span style=&quot;color:green&quot;&gt;2.  Normal Q-Q plot (Test of Normality of Data)&lt;/span&gt;&lt;/h5&gt;&lt;br&gt;</span>
<span class="s2">    - If fitted points align with 45 degree line, assumption of normality holds true.&lt;br&gt;</span>
<span class="s2">    - Technical note: We need to use fit=&#39;True&#39; parameter to compare fitted points</span>
<span class="s2">    with 45 degree.</span>
<span class="s2">    &lt;code class=&quot;inlinecode&quot;&gt; smg.qqplot(model_fitted.resid_pearson,line=&#39;45&#39;,fit=&#39;True&#39;) &lt;/code&gt;</span>

<span class="s2">&lt;h5&gt; &lt;span style=&quot;color:green&quot;&gt;3. Standardized Residuals Plot</span>
<span class="s2">    (Test of Constant Variance of Residuals, Homoskedasticity) &lt;/span&gt;&lt;/h5&gt;&lt;br&gt;</span>
<span class="s2">    - This is the plot after we standardize the residuals.&lt;br&gt;</span>
<span class="s2">    - If data points are clustered at left or right,</span>
<span class="s2">        the data exhibits heteroskedasticity.&lt;br&gt;</span>
<span class="s2">    - Assumption of constant variance of residual</span>
<span class="s2">        is violated.&lt;br&gt;</span>
<span class="s2">    - To reduce the heteroskedasticity, we may use non-linear transformations</span>
<span class="s2">        such as log1p, boxcox1p, sqrt, power(1/3) and so on.&lt;br&gt;</span>
<span class="s2">    - To reduce heteroskedasticity, we may use &lt; a href=&quot;http://www.statsmodels.org/0.6.1/examples/notebooks/generated/wls.html&quot; weighted least squares method. &lt;/a&gt; &lt;br&gt;</span>
<span class="s2">    - If we see few outliers with high y-values, we have high variance residual outliers.&lt;br&gt;</span>
<span class="s2">    - If the dataset follows Normal distribution, we can use Tukey&#39;s IQR (Inter Quartile Range)</span>
<span class="s2">        method to detect and treat the outliers.&lt;br&gt;</span>
<span class="s2">    - If the dataset is non-normal, we can use non-parametric methods such as &lt;a href=&quot;http://www.statsmodels.org/devel/generated/statsmodels.nonparametric.kde.KDEUnivariate.html&quot;&gt;Kernel Density Estimation&lt;/a&gt; to detetect and treat the outliers.&lt;br&gt;</span>
<span class="s2">    - Small residuals on y-axis is better.&lt;br&gt;</span>

<span class="s2">&lt;h5&gt; &lt;span style=&quot;color:green&quot;&gt;4. Leverage Plot for Residuals (Cook&#39;s Test of Outliers) &lt;/span&gt;&lt;/h5&gt; &lt;br&gt;</span>
<span class="s2">    - Solid &lt;span style=&quot;color:red&quot;&gt; red line&lt;/span&gt; is leverage best fit line.&lt;br&gt;</span>
<span class="s2">    - Dashed &lt;span style=&quot;color:red&quot;&gt; red line&lt;/span&gt; is Cook&#39;s distance for 0.5 * p * (1-x) /x.&lt;br&gt;</span>
<span class="s2">    - Dotted &lt;span style=&quot;color:red&quot;&gt; red line&lt;/span&gt; is Cook&#39;s distance for 1 * p * (1-x) /x.&lt;br&gt;</span>
<span class="s2">    - p is number of model parameters. x is plot values: np.linspace(0.001, 0.200, 50).&lt;br&gt;</span>
<span class="s2">    - If the values exceeds the farthest &lt;span style=&quot;color:red&quot;&gt; red line&lt;/span&gt;,</span>
<span class="s2">        it has high leverage on the dataset and may be considered an outlier.&lt;br&gt;</span>
<span class="s2">    - If we data points beyond Studentized (or Standardized) Residual of value 3,</span>
<span class="s2">        the data point may be an outlier.</span>

<span class="s2">&lt;/div&gt;</span>
<span class="s2">&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span> <span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="n">html</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="print_statsmodels_summary"><a class="viewcode-back" href="../../bhishan.html#bhishan.ml_statsmodels.print_statsmodels_summary">[docs]</a><span class="k">def</span> <span class="nf">print_statsmodels_summary</span><span class="p">(</span><span class="n">summary</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Print statsmodels fitted model summary with some color hightlights.</span>

<span class="sd">    Parameters</span>
<span class="sd">    -----------</span>
<span class="sd">    summary: object</span>
<span class="sd">        Statsmodel fitted model summary.</span>

<span class="sd">    Example</span>
<span class="sd">    --------</span>
<span class="sd">    .. code-block:: python</span>

<span class="sd">        import statsmodels.api as sm</span>
<span class="sd">        import statsmodels.formula.api as smf</span>
<span class="sd">        formula = &#39;price ~ sqft_living&#39;</span>
<span class="sd">        model = smf.ols(formula=formula, data= pd.concat([Xtrain,ytrain],axis=1))</span>
<span class="sd">        model_fit = model.fit()</span>
<span class="sd">        summary = model_fit.summary()</span>

<span class="sd">    Notes:</span>
<span class="sd">    ------</span>
<span class="sd">    Colors picked from: https://www.w3schools.com/colors/colors_picker.asp</span>


<span class="sd">    Example</span>
<span class="sd">    --------</span>
<span class="sd">    .. code-block:: python</span>

<span class="sd">        &#39;&#39;&#39;</span>
<span class="sd">        From: &#39;&lt;th&gt;  Adj. R-squared:    &lt;/th&gt;&#39;</span>
<span class="sd">        To  : &#39;&lt;th style=&quot;background-color:{};&quot;&gt; Adj. R-squared: &lt;/th&gt;&#39;</span>
<span class="sd">                &#39;&lt;th                              Adj. R-squared:    &lt;/th&gt;&#39;,</span>
<span class="sd">        Fill the color background inside &lt;th&gt; tag.</span>
<span class="sd">        &#39;&#39;&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">desc</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">&lt;div class=&quot;alert alert-block alert-info&quot;&gt;</span>
<span class="s2">&lt;div align=&quot;center&quot;&gt;</span>
<span class="s2">    &lt;h3&gt; Model Summary Description &lt;/h3&gt;</span>
<span class="s2">&lt;/div&gt;</span>

<span class="s2">&lt;h5&gt; &lt;span style=&quot;color:green&quot;&gt;1. R-squared (Coefficient of Determination) &lt;/span&gt; &lt;/h5&gt;</span>

<span class="s2">&lt;a href=&quot;https://www.wikiwand.com/en/Coefficient_of_determination&quot;&gt;Coefficient_of_determination&lt;/a&gt;&lt;br&gt;</span>

<span class="s2">    - R-squared = 1 - (SS_res / SS_tot)&lt;br&gt;</span>
<span class="s2">        SS_res = sum (y_i - f_i)**2  = sum(e_i **2)&lt;br&gt;</span>
<span class="s2">        SS_tot = sum (y_i - y_bar)**2&lt;br&gt;</span>
<span class="s2">    - If R2 = 0.49, then, 49</span><span class="si">% o</span><span class="s2">f the variability of the dependent</span>
<span class="s2">        variable has been accounted for, &lt;br&gt;</span>
<span class="s2">        and the remaining 51</span><span class="si">% o</span><span class="s2">f the</span>
<span class="s2">        variability is still unaccounted for.&lt;br&gt;</span>

<span class="s2">&lt;h5&gt; &lt;span style=&quot;color:green&quot;&gt;2. Adjusted R2 (R bar squared) &lt;/span&gt;&lt;/h5&gt;</span>
<span class="s2">&lt;a href=&quot;https://www.wikiwand.com/en/Coefficient_of_determination&quot;&gt;Coefficient_of_determination&lt;/a&gt;&lt;br&gt;</span>
<span class="s2">    - R_bar_squared = 1 - (1-R2) * (n-1) / (n-p-1)&lt;br&gt;</span>
<span class="s2">    - The adjusted R2 can be negative.&lt;br&gt;</span>
<span class="s2">    - It will always be less than or equal to that of R2.&lt;br&gt;</span>
<span class="s2">    - Adjusted R2 can be interpreted as an unbiased&lt;br&gt;</span>
<span class="s2">        (or less biased) estimator of the population R2.&lt;br&gt;</span>
<span class="s2">    - R2 is a positively biased estimate of the population value.&lt;br&gt;</span>
<span class="s2">        When p increases, R2 increases, but R_bar_squared may not increase.&lt;br&gt;</span>

<span class="s2">&lt;h5&gt; &lt;span style=&quot;color:green&quot;&gt;3. F-statistic &lt;/span&gt; &lt;/h5&gt;</span>
<span class="s2">&lt;a href=&quot;https://www.wikiwand.com/en/F-test&quot;&gt;F-statistic&lt;/a&gt;&lt;br&gt;</span>
<span class="s2">    -  the one-way ANOVA F-test statistic is&lt;br&gt;</span>
<span class="s2">		&lt;div class=&quot;alert alert-warning&quot;&gt;</span>
<span class="s2">			&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;explained variance&lt;br&gt;</span>
<span class="s2">		F=&amp;nbsp;  --------------------&lt;br&gt;</span>
<span class="s2">		&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;unexplained variance&lt;br&gt;</span>

<span class="s2">		&lt;/div&gt;</span>
<span class="s2">    - When there are only two groups for the one-way ANOVA F-test,</span>
<span class="s2">        F = t**2, where t is the Student&#39;s t statistic.&lt;br&gt;</span>
<span class="s2">    - For two models 1 and 2,</span>
<span class="s2">				&lt;div class=&quot;alert alert-warning&quot;&gt;</span>
<span class="s2">				    &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;(RSS1 - RSS2) / (p2-p1)&lt;br&gt;</span>
<span class="s2">				F=&amp;nbsp; --------------------&lt;br&gt;</span>
<span class="s2">				&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;(RSS2) / (n-p2)&lt;br&gt;</span>
<span class="s2">				&lt;/div&gt;</span>

<span class="s2">&lt;h5&gt; &lt;span style=&quot;color:green&quot;&gt;4. AIC &lt;/span&gt;&lt;/h5&gt;</span>
<span class="s2">&lt;a href=&quot;https://www.wikiwand.com/en/Akaike_information_criterion&quot;&gt;Akaike Information Criterion&lt;/a&gt;&lt;br&gt;</span>
<span class="s2">    - Akaike Information Criterion. &lt;br&gt;</span>
<span class="s2">    - AIC = 2k - 2 ln L  where k is the number of model parameters,</span>
<span class="s2">        L is log likelihood.&lt;br&gt;</span>
<span class="s2">    - Adjusts the log-likelihood based on the number of observations</span>
<span class="s2">        and the complexity of the model.&lt;br&gt;</span>
<span class="s2">    - Penalizes the model selection metrics when more independent</span>
<span class="s2">        variables are added.&lt;br&gt;</span>

<span class="s2">&lt;h5&gt; &lt;span style=&quot;color:green&quot;&gt;5. BIC &lt;/span&gt; &lt;/h5&gt;</span>
<span class="s2">&lt;a href=&quot;https://www.wikiwand.com/en/Bayesian_information_criterion&quot;&gt;Bayesian Information Criterion&lt;/a&gt;&lt;br&gt;</span>
<span class="s2">    - Bayesian Information Criterion.&lt;br&gt;</span>
<span class="s2">    - BIC = ln(n) * k - 2 ln L  where k is the number of model parameters,</span>
<span class="s2">        L is log likelihood.&lt;br&gt;</span>
<span class="s2">    - Similar to the AIC, but has a higher penalty for models with more parameters.&lt;br&gt;</span>
<span class="s2">    - Penalizes the model selection metrics when more independent variables are added.&lt;br&gt;</span>
<span class="s2">    -  BIC is only valid for sample size n much larger than</span>
<span class="s2">        the number k of parameters in the model.&lt;br&gt;</span>

<span class="s2">&lt;h5&gt; &lt;span style=&quot;color:green&quot;&gt;6. P &gt; |t| &lt;/span&gt;&lt;/h5&gt;</span>
<span class="s2">&lt;a href=&quot;https://www.wikiwand.com/en/P-value&quot;&gt;P-value&lt;/a&gt;&lt;br&gt;</span>
<span class="s2">    - p-value means probability value.&lt;br&gt;</span>
<span class="s2">    - p-value means that the null-hypothesis model parameter = 0 is true.&lt;br&gt;</span>
<span class="s2">    - If it is less than the confidence level, often 0.05,</span>
<span class="s2">        it indicates that there is a statistically significant</span>
<span class="s2">        relationship between the predictor and the response.&lt;br&gt;</span>

<span class="s2">&lt;h5&gt; &lt;span style=&quot;color:green&quot;&gt;7. Skewness  &lt;/span&gt; &lt;/h5&gt;</span>
<span class="s2">&lt;a href=&quot;https://www.wikiwand.com/en/Skewness&quot;&gt;Skewness&lt;/a&gt;&lt;br&gt;</span>
<span class="s2">    - A measure of the symmetry of the data about the mean.&lt;br&gt;</span>
<span class="s2">    - Normally-distributed errors should be symmetrically distributed about the mean.&lt;br&gt;</span>
<span class="s2">    - The normal distribution has 0 skew.&lt;br&gt;</span>

<span class="s2">&lt;h5&gt; &lt;span style=&quot;color:green&quot;&gt;8. Kurtosis &lt;/span&gt;&lt;/h5&gt;</span>
<span class="s2">&lt;a href=&quot;https://www.wikiwand.com/en/Kurtosis&quot;&gt;Kurtosis&lt;/a&gt;&lt;br&gt;</span>
<span class="s2">    - A measure of the shape of the distribution.&lt;br&gt;</span>
<span class="s2">    - The normal distribution has a Kurtosis of 3.&lt;br&gt;</span>
<span class="s2">    - If kurtosis is greater than 3, curve is tall and peaked.&lt;br&gt;</span>

<span class="s2">&lt;h5&gt; &lt;span style=&quot;color:green&quot;&gt;9. Omnibus D Angostino’s test &lt;/span&gt; &lt;/h5&gt;</span>
<span class="s2">&lt;a href=&quot;https://www.wikiwand.com/en/D%27Agostino</span><span class="si">%27s</span><span class="s2">_K-squared_test&quot;&gt;Omnibus D Angostino’s test&lt;/a&gt;&lt;br&gt;</span>
<span class="s2">    - It provides a combined statistical test for the presence of skewness and kurtosis.&lt;br&gt;</span>
<span class="s2">    - This is a goodness-of-fit measure of departure from normality,</span>
<span class="s2">        that is the test aims to establish whether or not the given sample</span>
<span class="s2">        comes from a normally distributed population.&lt;br&gt;</span>
<span class="s2">    - The test is based on transformations of the sample kurtosis and skewness,</span>
<span class="s2">        and has power only against the alternatives that the</span>
<span class="s2">        distribution is skewed and/or kurtic.&lt;br&gt;</span>

<span class="s2">&lt;h5&gt; &lt;span style=&quot;color:green&quot;&gt;10. Jarque-Bera &lt;/span&gt;&lt;/h5&gt;</span>
<span class="s2">&lt;a href=&quot;https://www.wikiwand.com/en/Jarque</span><span class="si">%E</span><span class="s2">2</span><span class="si">%80%</span><span class="s2">93Bera_test&quot;&gt;Jarque-Bera Test&lt;/a&gt;&lt;br&gt;</span>
<span class="s2">    - A different test of the skewness and kurtosis.&lt;br&gt;</span>
<span class="s2">    - In statistics, the Jarque–Bera test is a goodness-of-fit test of</span>
<span class="s2">        whether sample data have the skewness and kurtosis</span>
<span class="s2">        matching a normal distribution.&lt;br&gt;</span>
<span class="s2">    - The test statistic is always nonnegative.&lt;br&gt;</span>
<span class="s2">    - If it is far from zero, it signals the data do not have a normal distribution.&lt;br&gt;</span>

<span class="s2">&lt;h5&gt; &lt;span style=&quot;color:green&quot;&gt;11. Durbin-Watson &lt;/span&gt; &lt;/h5&gt;</span>
<span class="s2">&lt;a href=&quot;https://www.wikiwand.com/en/Durbin</span><span class="si">%E</span><span class="s2">2</span><span class="si">%80%</span><span class="s2">93Watson_statistic&quot;&gt;Durbin-Watson Stastistic&lt;/a&gt;&lt;br&gt;</span>
<span class="s2">    - In statistics, the Durbin–Watson statistic is a test statistic</span>
<span class="s2">        used to detect the presence of autocorrelation at lag 1 in the residuals.&lt;br&gt;</span>
<span class="s2">    - Often important in time-series analysis.&lt;br&gt;</span>
<span class="s2">    - A similar assessment can be also carried out with the</span>
<span class="s2">        Breusch–Godfrey test and the Ljung–Box test.&lt;br&gt;</span>

<span class="s2">&lt;h5&gt; &lt;span style=&quot;color:green&quot;&gt;12. Cond. No &lt;/span&gt;&lt;/h5&gt;</span>
<span class="s2">&lt;a href=&quot;https://www.wikiwand.com/en/Condition_number&quot;&gt;Condition Number&lt;/a&gt;&lt;br&gt;</span>
<span class="s2">    - The condition number of a function measures how much the output value</span>
<span class="s2">        of the function can change for a small change in the input argument.&lt;br&gt;</span>
<span class="s2">    - This is used to measure how sensitive a function is to changes</span>
<span class="s2">        or errors in the input.&lt;br&gt;</span>
<span class="s2">    - In linear regression the condition number of the moment matrix</span>
<span class="s2">        can be used as a diagnostic for multicollinearity.&lt;br&gt;</span>
<span class="s2">    - A problem with a low condition number is said to be well-conditioned.&lt;br&gt;</span>
<span class="s2">    - A problem with a high condition number is said to be ill-conditioned.&lt;br&gt;</span>

<span class="s2">&lt;/div&gt;</span>
<span class="s2">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span> <span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="n">desc</span><span class="p">))</span>

    <span class="n">summary_html</span> <span class="o">=</span> <span class="n">summary</span><span class="o">.</span><span class="n">as_html</span><span class="p">()</span>

    <span class="n">to_color_html_tags</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&lt;th&gt;  Adj. R-squared:    &lt;/th&gt;&#39;</span><span class="p">,</span>
                <span class="s1">&#39;&lt;th&gt;  F-statistic:       &lt;/th&gt;&#39;</span><span class="p">,</span>
                <span class="s1">&#39;&lt;th&gt;  AIC:               &lt;/th&gt;&#39;</span><span class="p">,</span>
                <span class="s1">&#39;&lt;th&gt;  BIC:               &lt;/th&gt;&#39;</span><span class="p">,</span>
                <span class="s1">&#39;&lt;th&gt;coef&lt;/th&gt;&#39;</span><span class="p">,</span>
                <span class="s1">&#39;&lt;th&gt;std err&lt;/th&gt;&#39;</span><span class="p">,</span>
                <span class="s1">&#39;&lt;th&gt;P&gt;|t|&lt;/th&gt;&#39;</span><span class="p">,</span>
                <span class="s1">&#39;&lt;th&gt;[0.025&lt;/th&gt;&#39;</span><span class="p">,</span>
                <span class="s1">&#39;&lt;th&gt;0.975]&lt;/th&gt;&#39;</span>
                <span class="p">]</span>

    <span class="n">light_background_colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;#aec7e8&#39;</span><span class="p">,</span> <span class="s1">&#39;#c7e9c0&#39;</span><span class="p">,</span><span class="s1">&#39;#bcbddc&#39;</span><span class="p">,</span><span class="s1">&#39;#ffe699&#39;</span><span class="p">,</span>
            <span class="s1">&#39;#808080&#39;</span><span class="p">,</span><span class="s1">&#39;#ccccff&#39;</span><span class="p">,</span><span class="s1">&#39;#ffd9b3&#39;</span><span class="p">,</span><span class="s1">&#39;#ff9896&#39;</span><span class="p">,</span>
            <span class="s1">&#39;#ff9896&#39;</span><span class="p">]</span>

    <span class="c1"># insert style background inside &lt;th&gt; tag.</span>
    <span class="n">colored_html_tags</span>  <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&lt;th style=&quot;background-color:</span><span class="si">{}</span><span class="s1">;&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">light_background_colors</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span>
        <span class="n">to_color_html_tags</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s1">&#39;&lt;th&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">to_color_html_tags</span><span class="p">))</span> <span class="p">]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">to_color_html_tags</span><span class="p">)):</span>
        <span class="n">summary_html</span> <span class="o">=</span> <span class="n">summary_html</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">to_color_html_tags</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                            <span class="n">colored_html_tags</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>


    <span class="k">return</span> <span class="n">HTML</span><span class="p">(</span><span class="n">summary_html</span><span class="p">)</span></div>

<span class="c1">################################</span>
<span class="c1">## ISLR Python</span>
<span class="c1">################################</span>
<span class="c1"># Functions to emulate R&#39;s lm().plot() functionality</span>

<div class="viewcode-block" id="lm_stats"><a class="viewcode-back" href="../../bhishan.html#bhishan.ml_statsmodels.lm_stats">[docs]</a><span class="k">def</span> <span class="nf">lm_stats</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get leverage and studentised residuals.</span>

<span class="sd">    Parameters</span>
<span class="sd">    -----------</span>
<span class="sd">    X: np.array</span>
<span class="sd">        Predictor variable.</span>
<span class="sd">    y: np.array</span>
<span class="sd">        Response variable.</span>
<span class="sd">    y_pred: np.array</span>
<span class="sd">        predictions of response variable.</span>

<span class="sd">    https://en.wikipedia.org/wiki/Studentized_residual#How_to_studentize</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Responses as np array vector</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span>
        <span class="c1"># take first dimension as vector</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

    <span class="c1"># Residuals</span>
    <span class="n">residuals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">y_pred</span><span class="p">)</span>

    <span class="c1"># Hat matrix</span>
    <span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">X</span><span class="p">))</span> <span class="o">@</span> <span class="n">X</span><span class="o">.</span><span class="n">T</span>

    <span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>

    <span class="c1"># Leverage</span>
    <span class="n">h_ii</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">diagonal</span><span class="p">()</span>

    <span class="c1">## Externally studentised residual</span>
    <span class="c1"># In this case external studentisation is most appropriate</span>
    <span class="c1"># because we are looking for outliers.</span>

    <span class="c1"># Estimate variance (externalised)</span>
    <span class="n">σi_est</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="c1"># exclude ith observation from estimation of variance</span>
        <span class="n">external_residuals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
        <span class="n">σi_est</span> <span class="o">+=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
                           <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">external_residuals</span><span class="p">)))]</span>
    <span class="n">σi_est</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">σi_est</span><span class="p">)</span>

    <span class="c1"># Externally studentised residuals</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">residuals</span> <span class="o">/</span> <span class="n">σi_est</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">h_ii</span><span class="p">)</span>


    <span class="c1"># Return dataframe</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span> <span class="p">{</span><span class="s1">&#39;residual&#39;</span><span class="p">:</span> <span class="n">residuals</span><span class="p">,</span>
                        <span class="s1">&#39;leverage&#39;</span><span class="p">:</span> <span class="n">h_ii</span><span class="p">,</span>
                        <span class="s1">&#39;studentised_residual&#39;</span><span class="p">:</span> <span class="n">t</span><span class="p">,</span>
                        <span class="s1">&#39;y_pred&#39;</span><span class="p">:</span> <span class="n">y_pred</span><span class="p">})</span></div>


<div class="viewcode-block" id="lm_plot"><a class="viewcode-back" href="../../bhishan.html#bhishan.ml_statsmodels.lm_plot">[docs]</a><span class="k">def</span> <span class="nf">lm_plot</span><span class="p">(</span><span class="n">df_X1train</span><span class="p">,</span> <span class="n">df_ytrain</span><span class="p">,</span> <span class="n">df_ypreds_train</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">ofile</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Provides R style residual plots based on results from lm_stats</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    df_X1train: pandas.DataFrame</span>
<span class="sd">        Pandas dataframe with bias column added.</span>
<span class="sd">    df_ytrain: pandas.Series</span>
<span class="sd">        Pandas series with response variable.</span>
<span class="sd">    df_ypreds_train: pandas.Series</span>
<span class="sd">        Pandas series of reponse variable predictions.</span>
<span class="sd">    verbose: bool</span>
<span class="sd">        Boolean to show whether to print description of stats or not.</span>
<span class="sd">    ofile: string</span>
<span class="sd">        Name of output file for plot.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>

    <span class="n">lm_stats_df</span> <span class="o">=</span> <span class="n">lm_stats</span><span class="p">(</span><span class="n">df_X1train</span><span class="p">,</span> <span class="n">df_ytrain</span><span class="p">,</span> <span class="n">df_ypreds_train</span><span class="p">)</span>

    <span class="c1"># Parse stats</span>
    <span class="n">t</span>      <span class="o">=</span> <span class="n">lm_stats_df</span><span class="p">[</span><span class="s1">&#39;studentised_residual&#39;</span><span class="p">]</span>
    <span class="n">h_ii</span>   <span class="o">=</span> <span class="n">lm_stats_df</span><span class="p">[</span><span class="s1">&#39;leverage&#39;</span><span class="p">]</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">lm_stats_df</span><span class="p">[</span><span class="s1">&#39;y_pred&#39;</span><span class="p">]</span>

    <span class="c1"># setup axis for grid</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">18</span><span class="p">))</span>

    <span class="c1"># Studentised residual plot</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">321</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">t</span><span class="p">,</span> <span class="n">lowess</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Fitted Values&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Studentised Residuals&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Externally Studentised Residual Plot&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="c1"># Draw Hastie and Tibshirani&#39;s bounds for possible outliers</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;y = ± 3&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=-</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">);</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>

    <span class="c1"># Normal Q-Q plot</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">322</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">probplot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">dist</span><span class="o">=</span><span class="s1">&#39;norm&#39;</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="n">plt</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Studentised Residuals&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Normal Q-Q Plot&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

    <span class="c1"># Standardised residuals</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">323</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">t</span><span class="p">)),</span> <span class="n">lowess</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Fitted Values&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;√Standardized Residuals&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Scale-Location&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

    <span class="c1"># Residuals vs Leverage plot</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">324</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">h_ii</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Leverage&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Studentised Residuals&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Externally Studentised Residual vs Leverage&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">);</span>
    <span class="k">if</span> <span class="n">ofile</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">ofile</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">);</span>
    <span class="n">desc</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    1. Externally Studentised Residual Plot (Outliers Test):</span>
<span class="s2">    - The horizontal red dashed lines are studentised t values t = ± 3</span>
<span class="s2">    - The points outside t = ± 3 may be considered outliers.</span>
<span class="s2">    - If we see U-shaped fitted solid blue line, our data is non-linear.</span>
<span class="s2">        We might need to transoform features or include polynomial features.</span>

<span class="s2">    2. Normal Q-Q Plot (Test of Normality)</span>
<span class="s2">    - If fitted points align with 45 degree line,</span>
<span class="s2">        the assumption of normality is likey to hold true.</span>

<span class="s2">    3. Scale-Location Plot (Test of Constant Variance, homoskedasticity)</span>
<span class="s2">    - Small residuals on y-axis is better.</span>
<span class="s2">    - If we see conical shape, data is heteroskedastic.</span>
<span class="s2">    - If data points are clustered at left or right, we observe heteroskedasticity.</span>
<span class="s2">    - If we see few outliers with high y-values,</span>
<span class="s2">        we have high variance residual outliers.</span>

<span class="s2">    4. Residuals vs Leverage Plot (Outliers Test)</span>
<span class="s2">    - Studentised residual larger than 3 are potential outliers.</span>
<span class="s2">    - High leverage points are potential outliers.</span>
<span class="s2">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="n">desc</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>

<div class="viewcode-block" id="lm_residual_corr_plot"><a class="viewcode-back" href="../../bhishan.html#bhishan.ml_statsmodels.lm_residual_corr_plot">[docs]</a><span class="k">def</span> <span class="nf">lm_residual_corr_plot</span><span class="p">(</span><span class="n">df_X1train</span><span class="p">,</span><span class="n">df_ytrain</span><span class="p">,</span><span class="n">df_ypreds_train</span><span class="p">,</span>
                            <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">ofile</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Linear models residual correlation plots.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    df_X1train: pandas.DataFrame</span>
<span class="sd">        Pandas dataframe with bias column added.</span>
<span class="sd">    df_ytrain: pandas.Series</span>
<span class="sd">        Pandas series with response variable.</span>
<span class="sd">    df_ypreds_train: pandas.Series</span>
<span class="sd">        Pandas series of reponse variable predictions.</span>
<span class="sd">    verbose: bool</span>
<span class="sd">        Boolean to show whether to print description of stats or not.</span>
<span class="sd">    ofile: string</span>
<span class="sd">        Name of output file for plot.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lm_stats_df</span> <span class="o">=</span> <span class="n">lm_stats</span><span class="p">(</span><span class="n">df_X1train</span><span class="p">,</span> <span class="n">df_ytrain</span><span class="p">,</span> <span class="n">df_ypreds_train</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">lm_stats_df</span><span class="p">[</span><span class="s1">&#39;residual&#39;</span><span class="p">]</span>
    <span class="c1"># Residuals correlation</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])),</span> <span class="n">y</span><span class="o">=</span><span class="n">r</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Observation&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Residual&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Correlation of Error Terms&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">);</span>
    <span class="n">desc</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    1. Correlation of Error Terms (Collinearity Test):</span>
<span class="s2">    - If the magnitude of errors increase/decrease as we go along x-axis,</span>
<span class="s2">        the error terms may be correlated.</span>
<span class="s2">    -   This could mean that our estimated standard errors underestimate</span>
<span class="s2">        the true standard errors.</span>
<span class="s2">    - Our confidence and prediction intervals may be</span>
<span class="s2">        narrower than they should be.</span>
<span class="s2">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="n">desc</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ofile</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">ofile</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Bhishan 1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, Bhishan Poudel.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.0.4.
    </div>
  </body>
</html>